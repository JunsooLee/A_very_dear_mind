\hypertarget{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer}{}\doxysection{trainer.\+trainer.\+Faster\+R\+C\+N\+N\+Trainer 클래스 참조}
\label{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer}\index{trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}}


trainer.\+trainer.\+Faster\+R\+C\+N\+N\+Trainer에 대한 상속 다이어그램 \+: \nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=241pt]{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer__inherit__graph}
\end{center}
\end{figure}


trainer.\+trainer.\+Faster\+R\+C\+N\+N\+Trainer에 대한 협력 다이어그램\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=241pt]{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public 멤버 함수}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_ad895a227899f59687507d786f688142e}{\+\_\+\+\_\+init\+\_\+\+\_\+}} (self, \mbox{\hyperlink{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a585898ea7cd93f2a4d0dec901ce9ad0b}{faster\+\_\+rcnn}})
\item 
def \mbox{\hyperlink{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a90ffc337dd9734de3e90f4c6dfc2225e}{forward}} (self, imgs, bboxes, labels, scale)
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{namespace_train}{Train}} forward code \end{DoxyCompactList}\item 
def \mbox{\hyperlink{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_ab0bc299051a745ffe6ef5c4660e05f51}{train\+\_\+step}} (self, imgs, bboxes, labels, scale)
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{namespace_train}{Train}} step code \end{DoxyCompactList}\item 
def \mbox{\hyperlink{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_ab67a69d3acacbf55be66451e3f3ae757}{save}} (self, save\+\_\+optimizer=False, save\+\_\+path=None, $\ast$$\ast$kwargs)
\item 
def \mbox{\hyperlink{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a15aba4b87ce03c4c47074dfed702cad5}{load}} (self, path, load\+\_\+optimizer=True, parse\+\_\+opt=False)
\item 
def \mbox{\hyperlink{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a7f8ea203d8d248e8df09e3d7c53581a4}{update\+\_\+meters}} (self, losses)
\item 
def \mbox{\hyperlink{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_af85f859ed833b523e162e4b0e8278173}{reset\+\_\+meters}} (self)
\item 
def \mbox{\hyperlink{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a9f737e863596d6b656919faefcf07ca4}{get\+\_\+meter\+\_\+data}} (self)
\end{DoxyCompactItemize}
\doxysubsection*{Public 속성}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a585898ea7cd93f2a4d0dec901ce9ad0b}{faster\+\_\+rcnn}}
\item 
\mbox{\hyperlink{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a85782798c1dea1fdc3c842c4c6657f66}{rpn\+\_\+sigma}}
\item 
\mbox{\hyperlink{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a71c4bf599a2529633d3513294ac3b357}{roi\+\_\+sigma}}
\item 
\mbox{\hyperlink{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_abf7b9da182f3cc3943da1893fd267070}{anchor\+\_\+target\+\_\+creator}}
\item 
\mbox{\hyperlink{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a0502776c51d33285e5be3d12ef074475}{proposal\+\_\+target\+\_\+creator}}
\item 
\mbox{\hyperlink{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a1cc0be2dc6218efbe42b86b8556e99ac}{loc\+\_\+normalize\+\_\+mean}}
\item 
\mbox{\hyperlink{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_abd942225e0f18bdd46b9a6db4d32e829}{loc\+\_\+normalize\+\_\+std}}
\item 
\mbox{\hyperlink{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_aa18be9d9e223d098f280c5ae7967e737}{optimizer}}
\end{DoxyCompactItemize}


\doxysubsection{상세한 설명}
\begin{DoxyVerb}wrapper for conveniently training. return losses

The losses include:

* :obj:`rpn_loc_loss`: The localization loss for \
    Region Proposal Network (RPN).
* :obj:`rpn_cls_loss`: The classification loss for RPN.
* :obj:`roi_loc_loss`: The localization loss for the head module.
* :obj:`roi_cls_loss`: The classification loss for the head module.
* :obj:`total_loss`: The sum of 4 loss above.

Args:
    faster_rcnn (model.FasterRCNN):
        A Faster R-CNN model that is going to be trained.
\end{DoxyVerb}
 

trainer.\+py 파일의 24 번째 라인에서 정의되었습니다.



\doxysubsection{생성자 \& 소멸자 문서화}
\mbox{\Hypertarget{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_ad895a227899f59687507d786f688142e}\label{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_ad895a227899f59687507d786f688142e}} 
\index{trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}!\_\_init\_\_@{\_\_init\_\_}}
\index{\_\_init\_\_@{\_\_init\_\_}!trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}}
\doxysubsubsection{\texorpdfstring{\_\_init\_\_()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def trainer.\+trainer.\+Faster\+R\+C\+N\+N\+Trainer.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{faster\+\_\+rcnn }\end{DoxyParamCaption})}



trainer.\+py 파일의 41 번째 라인에서 정의되었습니다.


\begin{DoxyCode}{0}
\DoxyCodeLine{41     \textcolor{keyword}{def }\mbox{\hyperlink{classutils_1_1vis__tool_1_1_visualizer_a2d7471603ca0e5fff1ad001341c31f46}{\_\_init\_\_}}(self, faster\_rcnn):}
\DoxyCodeLine{42         super(FasterRCNNTrainer, self).\mbox{\hyperlink{classutils_1_1vis__tool_1_1_visualizer_a2d7471603ca0e5fff1ad001341c31f46}{\_\_init\_\_}}()}
\DoxyCodeLine{43 }
\DoxyCodeLine{44         self.faster\_rcnn = faster\_rcnn}
\DoxyCodeLine{45         self.rpn\_sigma = opt.rpn\_sigma}
\DoxyCodeLine{46         self.roi\_sigma = opt.roi\_sigma}
\DoxyCodeLine{47 }
\DoxyCodeLine{48         \textcolor{comment}{\# target creator create gt\_bbox gt\_label etc as training targets. }}
\DoxyCodeLine{49         self.anchor\_target\_creator = AnchorTargetCreator()}
\DoxyCodeLine{50         self.proposal\_target\_creator = ProposalTargetCreator()}
\DoxyCodeLine{51 }
\DoxyCodeLine{52         self.loc\_normalize\_mean = faster\_rcnn.loc\_normalize\_mean}
\DoxyCodeLine{53         self.loc\_normalize\_std = faster\_rcnn.loc\_normalize\_std}
\DoxyCodeLine{54 }
\DoxyCodeLine{55         self.optimizer = self.faster\_rcnn.get\_optimizer()}
\DoxyCodeLine{56 }

\end{DoxyCode}


\doxysubsection{멤버 함수 문서화}
\mbox{\Hypertarget{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a90ffc337dd9734de3e90f4c6dfc2225e}\label{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a90ffc337dd9734de3e90f4c6dfc2225e}} 
\index{trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}!forward@{forward}}
\index{forward@{forward}!trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}}
\doxysubsubsection{\texorpdfstring{forward()}{forward()}}
{\footnotesize\ttfamily def trainer.\+trainer.\+Faster\+R\+C\+N\+N\+Trainer.\+forward (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{imgs,  }\item[{}]{bboxes,  }\item[{}]{labels,  }\item[{}]{scale }\end{DoxyParamCaption})}



\mbox{\hyperlink{namespace_train}{Train}} forward code 


\begin{DoxyParams}{매개변수}
{\em imgs} & input image \\
\hline
{\em bboxes} & B.\+B 정보, shape = (y1,x1,y2,x2) \\
\hline
{\em labels} & label 정보 \\
\hline
{\em scale} & 이미지 resize 비율 \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{반환값}
losses \begin{DoxyVerb}Forward Faster R-CNN and calculate losses.

Here are notations used.

* :math:`N` is the batch size.
* :math:`R` is the number of bounding boxes per image.

Currently, only :math:`N=1` is supported.

Args:
    imgs (~torch.autograd.Variable): A variable with a batch of images.
    --> shape: 1 * 3 * height * width

    bboxes (~torch.autograd.Variable): A batch of bounding boxes.
Its shape is :math:`(N, R, 4)`.
    labels (~torch.autograd..Variable): A batch of labels.
Its shape is :math:`(N, R)`. The background is excluded from
the definition, which means that the range of the value
is :math:`[0, L - 1]`. :math:`L` is the number of foreground
classes.
    scale (float): Amount of scaling applied to
the raw image during preprocessing.

Returns:
    namedtuple of 5 losses
\end{DoxyVerb}
 
\end{DoxyReturn}


trainer.\+py 파일의 65 번째 라인에서 정의되었습니다.


\begin{DoxyCode}{0}
\DoxyCodeLine{65     \textcolor{keyword}{def }forward(self, imgs, bboxes, labels, scale):}
\DoxyCodeLine{66         \textcolor{stringliteral}{"""Forward Faster R-\/CNN and calculate losses.}}
\DoxyCodeLine{67 \textcolor{stringliteral}{}}
\DoxyCodeLine{68 \textcolor{stringliteral}{        Here are notations used.}}
\DoxyCodeLine{69 \textcolor{stringliteral}{}}
\DoxyCodeLine{70 \textcolor{stringliteral}{        * :math:`N` is the batch size.}}
\DoxyCodeLine{71 \textcolor{stringliteral}{        * :math:`R` is the number of bounding boxes per image.}}
\DoxyCodeLine{72 \textcolor{stringliteral}{}}
\DoxyCodeLine{73 \textcolor{stringliteral}{        Currently, only :math:`N=1` is supported.}}
\DoxyCodeLine{74 \textcolor{stringliteral}{}}
\DoxyCodeLine{75 \textcolor{stringliteral}{        Args:}}
\DoxyCodeLine{76 \textcolor{stringliteral}{            imgs (~torch.autograd.Variable): A variable with a batch of images.}}
\DoxyCodeLine{77 \textcolor{stringliteral}{            -\/-\/> shape: 1 * 3 * height * width}}
\DoxyCodeLine{78 \textcolor{stringliteral}{}}
\DoxyCodeLine{79 \textcolor{stringliteral}{            bboxes (~torch.autograd.Variable): A batch of bounding boxes.}}
\DoxyCodeLine{80 \textcolor{stringliteral}{                Its shape is :math:`(N, R, 4)`.}}
\DoxyCodeLine{81 \textcolor{stringliteral}{            labels (~torch.autograd..Variable): A batch of labels.}}
\DoxyCodeLine{82 \textcolor{stringliteral}{                Its shape is :math:`(N, R)`. The background is excluded from}}
\DoxyCodeLine{83 \textcolor{stringliteral}{                the definition, which means that the range of the value}}
\DoxyCodeLine{84 \textcolor{stringliteral}{                is :math:`[0, L -\/ 1]`. :math:`L` is the number of foreground}}
\DoxyCodeLine{85 \textcolor{stringliteral}{                classes.}}
\DoxyCodeLine{86 \textcolor{stringliteral}{            scale (float): Amount of scaling applied to}}
\DoxyCodeLine{87 \textcolor{stringliteral}{                the raw image during preprocessing.}}
\DoxyCodeLine{88 \textcolor{stringliteral}{}}
\DoxyCodeLine{89 \textcolor{stringliteral}{        Returns:}}
\DoxyCodeLine{90 \textcolor{stringliteral}{            namedtuple of 5 losses}}
\DoxyCodeLine{91 \textcolor{stringliteral}{        """}}
\DoxyCodeLine{92         n = bboxes.shape[0]}
\DoxyCodeLine{93         \textcolor{keywordflow}{if} n != 1:}
\DoxyCodeLine{94             \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{'Currently only batch size 1 is supported.'})}
\DoxyCodeLine{95 }
\DoxyCodeLine{96         \_, \_, H, W = imgs.shape}
\DoxyCodeLine{97         img\_size = (H, W)}
\DoxyCodeLine{98 }
\DoxyCodeLine{99         \textcolor{comment}{\# F.M shape = (1 * 512 * height(input height/16) * width(input width/16))}}
\DoxyCodeLine{100         features = self.faster\_rcnn.\mbox{\hyperlink{example__classifier_8m_ae2af5012782a0b8a6f0389240434eb0c}{extractor}}(imgs)}
\DoxyCodeLine{101 }
\DoxyCodeLine{102         \textcolor{comment}{\# -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ RPN forward -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\#}}
\DoxyCodeLine{103         \textcolor{comment}{\# rpn.py}}
\DoxyCodeLine{104         rpn\_locs, rpn\_scores, rois, roi\_indices, anchor = \(\backslash\)}
\DoxyCodeLine{105             self.faster\_rcnn.rpn(features, img\_size, scale)}
\DoxyCodeLine{106 }
\DoxyCodeLine{107         \textcolor{comment}{\# Since batch size is one, convert variables to singular form ex) 1 * 1984 * 4 이면 1984 * 4로 변경}}
\DoxyCodeLine{108         bbox = bboxes[0]}
\DoxyCodeLine{109         label = labels[0]}
\DoxyCodeLine{110         rpn\_score = rpn\_scores[0]}
\DoxyCodeLine{111         rpn\_loc = rpn\_locs[0]}
\DoxyCodeLine{112         roi = rois}
\DoxyCodeLine{113 }
\DoxyCodeLine{114         \textcolor{comment}{\# -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ RPN losses -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\#}}
\DoxyCodeLine{115         \textcolor{comment}{\# rpn\_gt\_loc\_label.py}}
\DoxyCodeLine{116         gt\_rpn\_loc, gt\_rpn\_label = self.anchor\_target\_creator(}
\DoxyCodeLine{117             at.tonumpy(bbox),}
\DoxyCodeLine{118             anchor,}
\DoxyCodeLine{119             img\_size)}
\DoxyCodeLine{120 }
\DoxyCodeLine{121         \textcolor{comment}{\# 전체 anchor 좌표와 B.B와의 상대좌표를 기록한 배열 -\/-\/> shape = (F.M H * W * A, 4) 이지만 안에는 값은 inside\_index 안에만 기록되어 있음}}
\DoxyCodeLine{122         gt\_rpn\_label = at.tovariable(gt\_rpn\_label).long()}
\DoxyCodeLine{123         \textcolor{comment}{\# anchor에 대한 label을 기록한 배열 -\/-\/> shape = (F.M H * W * A, 4(ctr\_y, ctr\_X, h, w))}}
\DoxyCodeLine{124         gt\_rpn\_loc = at.tovariable(gt\_rpn\_loc)}
\DoxyCodeLine{125 }
\DoxyCodeLine{126         \textcolor{comment}{\# RPN regression loss}}
\DoxyCodeLine{127         rpn\_loc\_loss = \mbox{\hyperlink{namespacetrainer_1_1trainer_a9e9a6a7e132183a3066e077779de4664}{\_fast\_rcnn\_loc\_loss}}(}
\DoxyCodeLine{128             rpn\_loc, \textcolor{comment}{\# rpn\_locs -\/-\/> F.M의 하나의 픽셀당 9개의 anchor들 = pred location 즉 layer를 통해서 나온 값이다.}}
\DoxyCodeLine{129             gt\_rpn\_loc,}
\DoxyCodeLine{130             gt\_rpn\_label.data,}
\DoxyCodeLine{131             self.rpn\_sigma)}
\DoxyCodeLine{132 }
\DoxyCodeLine{133         \textcolor{comment}{\# RPN classification loss}}
\DoxyCodeLine{134         \textcolor{comment}{\# TODO focal loss 적용 해보기}}
\DoxyCodeLine{135         rpn\_cls\_loss = F.cross\_entropy(rpn\_score, gt\_rpn\_label.cuda(), ignore\_index=-\/1)}
\DoxyCodeLine{136 }
\DoxyCodeLine{137         \textcolor{comment}{\# -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ Sample RoIs and forward -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\#}}
\DoxyCodeLine{138         \textcolor{comment}{\# roi\_sample.py}}
\DoxyCodeLine{139         sample\_roi, gt\_roi\_loc, gt\_roi\_label = self.proposal\_target\_creator(}
\DoxyCodeLine{140             roi,}
\DoxyCodeLine{141             at.tonumpy(bbox),}
\DoxyCodeLine{142             at.tonumpy(label),}
\DoxyCodeLine{143             self.loc\_normalize\_mean,}
\DoxyCodeLine{144             self.loc\_normalize\_std)}
\DoxyCodeLine{145 }
\DoxyCodeLine{146         \textcolor{comment}{\# @note it's all zero because now it only support for batch=1 now}}
\DoxyCodeLine{147         sample\_roi\_index = t.zeros(len(sample\_roi))}
\DoxyCodeLine{148 }
\DoxyCodeLine{149         \textcolor{comment}{\# roi\_module.py}}
\DoxyCodeLine{150         \textcolor{comment}{\# TODO network 수정 시 pooling layer input 변경}}
\DoxyCodeLine{151         roi\_cls\_loc, roi\_score = self.faster\_rcnn.head(}
\DoxyCodeLine{152             features,}
\DoxyCodeLine{153             sample\_roi,}
\DoxyCodeLine{154             sample\_roi\_index)}
\DoxyCodeLine{155 }
\DoxyCodeLine{156         \textcolor{comment}{\# -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ ROI losses (fast rcnn loss) -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\#}}
\DoxyCodeLine{157         n\_sample = roi\_cls\_loc.shape[0]}
\DoxyCodeLine{158         roi\_cls\_loc = roi\_cls\_loc.view(n\_sample, -\/1, 4)}
\DoxyCodeLine{159         roi\_loc = roi\_cls\_loc[t.arange(0, n\_sample).long().cuda(), \(\backslash\)}
\DoxyCodeLine{160                               at.totensor(gt\_roi\_label).long()]}
\DoxyCodeLine{161         gt\_roi\_label = at.tovariable(gt\_roi\_label).long()}
\DoxyCodeLine{162         gt\_roi\_loc = at.tovariable(gt\_roi\_loc)}
\DoxyCodeLine{163 }
\DoxyCodeLine{164         \textcolor{comment}{\# ROI regression loss}}
\DoxyCodeLine{165         roi\_loc\_loss = \mbox{\hyperlink{namespacetrainer_1_1trainer_a9e9a6a7e132183a3066e077779de4664}{\_fast\_rcnn\_loc\_loss}}(}
\DoxyCodeLine{166             roi\_loc.contiguous(), \textcolor{comment}{\# layer 거쳐서 나온 B.B}}
\DoxyCodeLine{167             gt\_roi\_loc.float(), \textcolor{comment}{\# 실제 B.B 와의 상대좌표 결과값.}}
\DoxyCodeLine{168             gt\_roi\_label.data, \textcolor{comment}{\# label값. pos와 neg 섞여 있음}}
\DoxyCodeLine{169             self.roi\_sigma)}
\DoxyCodeLine{170 }
\DoxyCodeLine{171         \textcolor{comment}{\# ROI classification loss}}
\DoxyCodeLine{172         roi\_cls\_loss = nn.CrossEntropyLoss()(roi\_score, gt\_roi\_label.cuda())}
\DoxyCodeLine{173 }
\DoxyCodeLine{174         \textcolor{comment}{\# -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\#}}
\DoxyCodeLine{175         losses = [rpn\_loc\_loss, rpn\_cls\_loss, roi\_loc\_loss, roi\_cls\_loss]}
\DoxyCodeLine{176         losses = losses + [sum(losses)] \textcolor{comment}{\# loss[4]째에 전체다 더한 것을 보냄.}}
\DoxyCodeLine{177         print(losses)}
\DoxyCodeLine{178         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacetrainer_1_1trainer_af7f4095ccf1d1e68a9de60102936ab09}{LossTuple}}(*losses)}
\DoxyCodeLine{179 }

\end{DoxyCode}
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a90ffc337dd9734de3e90f4c6dfc2225e_cgraph}
\end{center}
\end{figure}
이 함수를 호출하는 함수들에 대한 그래프입니다.\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a90ffc337dd9734de3e90f4c6dfc2225e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a9f737e863596d6b656919faefcf07ca4}\label{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a9f737e863596d6b656919faefcf07ca4}} 
\index{trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}!get\_meter\_data@{get\_meter\_data}}
\index{get\_meter\_data@{get\_meter\_data}!trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}}
\doxysubsubsection{\texorpdfstring{get\_meter\_data()}{get\_meter\_data()}}
{\footnotesize\ttfamily def trainer.\+trainer.\+Faster\+R\+C\+N\+N\+Trainer.\+get\+\_\+meter\+\_\+data (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



trainer.\+py 파일의 256 번째 라인에서 정의되었습니다.


\begin{DoxyCode}{0}
\DoxyCodeLine{256     \textcolor{keyword}{def }get\_meter\_data(self):}
\DoxyCodeLine{257         \textcolor{keywordflow}{return} \{k: v.value()[0] \textcolor{keywordflow}{for} k, v \textcolor{keywordflow}{in} self.meters.items()\}}
\DoxyCodeLine{258 }

\end{DoxyCode}
\mbox{\Hypertarget{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a15aba4b87ce03c4c47074dfed702cad5}\label{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a15aba4b87ce03c4c47074dfed702cad5}} 
\index{trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}!load@{load}}
\index{load@{load}!trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}}
\doxysubsubsection{\texorpdfstring{load()}{load()}}
{\footnotesize\ttfamily def trainer.\+trainer.\+Faster\+R\+C\+N\+N\+Trainer.\+load (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{path,  }\item[{}]{load\+\_\+optimizer = {\ttfamily True},  }\item[{}]{parse\+\_\+opt = {\ttfamily False} }\end{DoxyParamCaption})}



trainer.\+py 파일의 232 번째 라인에서 정의되었습니다.


\begin{DoxyCode}{0}
\DoxyCodeLine{232     \textcolor{keyword}{def }\mbox{\hyperlink{example__classifier_8m_a998f67887464aef7f044115722929ded}{load}}(self, path, load\_optimizer=True, parse\_opt=False, ):}
\DoxyCodeLine{233         state\_dict = t.load(path)}
\DoxyCodeLine{234         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'model'} \textcolor{keywordflow}{in} state\_dict:}
\DoxyCodeLine{235             self.faster\_rcnn.\mbox{\hyperlink{classutils_1_1vis__tool_1_1_visualizer_aacc350d2964108c5e43a5be4f53c61bf}{load\_state\_dict}}(state\_dict[\textcolor{stringliteral}{'model'}])}
\DoxyCodeLine{236         \textcolor{keywordflow}{else}:  \textcolor{comment}{\# legacy way, for backward compatibility}}
\DoxyCodeLine{237             self.faster\_rcnn.\mbox{\hyperlink{classutils_1_1vis__tool_1_1_visualizer_aacc350d2964108c5e43a5be4f53c61bf}{load\_state\_dict}}(state\_dict)}
\DoxyCodeLine{238             \textcolor{keywordflow}{return} self}
\DoxyCodeLine{239         \textcolor{keywordflow}{if} parse\_opt:}
\DoxyCodeLine{240             opt.\_parse(state\_dict[\textcolor{stringliteral}{'config'}])}
\DoxyCodeLine{241         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'optimizer'} \textcolor{keywordflow}{in} state\_dict \textcolor{keywordflow}{and} load\_optimizer:}
\DoxyCodeLine{242             self.optimizer.\mbox{\hyperlink{classutils_1_1vis__tool_1_1_visualizer_aacc350d2964108c5e43a5be4f53c61bf}{load\_state\_dict}}(state\_dict[\textcolor{stringliteral}{'optimizer'}])}
\DoxyCodeLine{243         \textcolor{keywordflow}{return} self}
\DoxyCodeLine{244 }

\end{DoxyCode}
\mbox{\Hypertarget{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_af85f859ed833b523e162e4b0e8278173}\label{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_af85f859ed833b523e162e4b0e8278173}} 
\index{trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}!reset\_meters@{reset\_meters}}
\index{reset\_meters@{reset\_meters}!trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}}
\doxysubsubsection{\texorpdfstring{reset\_meters()}{reset\_meters()}}
{\footnotesize\ttfamily def trainer.\+trainer.\+Faster\+R\+C\+N\+N\+Trainer.\+reset\+\_\+meters (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



trainer.\+py 파일의 250 번째 라인에서 정의되었습니다.


\begin{DoxyCode}{0}
\DoxyCodeLine{250     \textcolor{keyword}{def }reset\_meters(self):}
\DoxyCodeLine{251         \textcolor{keywordflow}{for} key, meter \textcolor{keywordflow}{in} self.meters.items():}
\DoxyCodeLine{252             meter.reset()}
\DoxyCodeLine{253         self.roi\_cm.reset()}
\DoxyCodeLine{254         self.rpn\_cm.reset()}
\DoxyCodeLine{255 }

\end{DoxyCode}
\mbox{\Hypertarget{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_ab67a69d3acacbf55be66451e3f3ae757}\label{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_ab67a69d3acacbf55be66451e3f3ae757}} 
\index{trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}!save@{save}}
\index{save@{save}!trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}}
\doxysubsubsection{\texorpdfstring{save()}{save()}}
{\footnotesize\ttfamily def trainer.\+trainer.\+Faster\+R\+C\+N\+N\+Trainer.\+save (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{save\+\_\+optimizer = {\ttfamily False},  }\item[{}]{save\+\_\+path = {\ttfamily None},  }\item[{$\ast$$\ast$}]{kwargs }\end{DoxyParamCaption})}

\begin{DoxyVerb}serialize models include optimizer and other info
return path where the model-file is stored.
Args:
    save_optimizer (bool): whether save optimizer.state_dict().
    save_path (string): where to save model, if it's None, save_path
is generate using time str and info from kwargs.

Returns:
    save_path(str): the path to save models.
\end{DoxyVerb}
 

trainer.\+py 파일의 197 번째 라인에서 정의되었습니다.


\begin{DoxyCode}{0}
\DoxyCodeLine{197     \textcolor{keyword}{def }\mbox{\hyperlink{example__classifier_8m_a97f1718d165833c17855aabcafb3cdf0}{save}}(self, save\_optimizer=False, save\_path=None, **kwargs):}
\DoxyCodeLine{198         \textcolor{stringliteral}{"""serialize models include optimizer and other info}}
\DoxyCodeLine{199 \textcolor{stringliteral}{        return path where the model-\/file is stored.}}
\DoxyCodeLine{200 \textcolor{stringliteral}{        Args:}}
\DoxyCodeLine{201 \textcolor{stringliteral}{            save\_optimizer (bool): whether save optimizer.state\_dict().}}
\DoxyCodeLine{202 \textcolor{stringliteral}{            save\_path (string): where to save model, if it's None, save\_path}}
\DoxyCodeLine{203 \textcolor{stringliteral}{                is generate using time str and info from kwargs.}}
\DoxyCodeLine{204 \textcolor{stringliteral}{}}
\DoxyCodeLine{205 \textcolor{stringliteral}{        Returns:}}
\DoxyCodeLine{206 \textcolor{stringliteral}{            save\_path(str): the path to save models.}}
\DoxyCodeLine{207 \textcolor{stringliteral}{        """}}
\DoxyCodeLine{208         save\_dict = dict()}
\DoxyCodeLine{209 }
\DoxyCodeLine{210         save\_dict[\textcolor{stringliteral}{'model'}] = self.faster\_rcnn.\mbox{\hyperlink{classutils_1_1vis__tool_1_1_visualizer_a0ca804c55b7a928d35f4ccdf05118bbe}{state\_dict}}()}
\DoxyCodeLine{211         save\_dict[\textcolor{stringliteral}{'config'}] = opt.\_state\_dict()}
\DoxyCodeLine{212         save\_dict[\textcolor{stringliteral}{'other\_info'}] = kwargs}
\DoxyCodeLine{213         \textcolor{comment}{\# save\_dict['vis\_info'] = self.vis.state\_dict()}}
\DoxyCodeLine{214 }
\DoxyCodeLine{215         \textcolor{keywordflow}{if} save\_optimizer:}
\DoxyCodeLine{216             save\_dict[\textcolor{stringliteral}{'optimizer'}] = self.optimizer.\mbox{\hyperlink{classutils_1_1vis__tool_1_1_visualizer_a0ca804c55b7a928d35f4ccdf05118bbe}{state\_dict}}()}
\DoxyCodeLine{217 }
\DoxyCodeLine{218         \textcolor{keywordflow}{if} save\_path \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{219             timestr = time.strftime(\textcolor{stringliteral}{'\%m\%d\%H\%M'})}
\DoxyCodeLine{220             save\_path = \textcolor{stringliteral}{'./checkpoints/fasterrcnn\_\%s'} \% timestr}
\DoxyCodeLine{221             \textcolor{keywordflow}{for} k\_, v\_ \textcolor{keywordflow}{in} kwargs.items():}
\DoxyCodeLine{222                 save\_path += \textcolor{stringliteral}{'\_\%.4s'} \% v\_}
\DoxyCodeLine{223             save\_path += \textcolor{stringliteral}{'.pth'}}
\DoxyCodeLine{224         save\_dir = os.path.dirname(save\_path)}
\DoxyCodeLine{225         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} os.path.exists(save\_dir):}
\DoxyCodeLine{226             os.makedirs(save\_dir)}
\DoxyCodeLine{227 }
\DoxyCodeLine{228         t.save(save\_dict, save\_path)}
\DoxyCodeLine{229         \textcolor{comment}{\# self.vis.save([self.vis.env])}}
\DoxyCodeLine{230         \textcolor{keywordflow}{return} save\_path}
\DoxyCodeLine{231 }

\end{DoxyCode}
\mbox{\Hypertarget{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_ab0bc299051a745ffe6ef5c4660e05f51}\label{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_ab0bc299051a745ffe6ef5c4660e05f51}} 
\index{trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}!train\_step@{train\_step}}
\index{train\_step@{train\_step}!trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}}
\doxysubsubsection{\texorpdfstring{train\_step()}{train\_step()}}
{\footnotesize\ttfamily def trainer.\+trainer.\+Faster\+R\+C\+N\+N\+Trainer.\+train\+\_\+step (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{imgs,  }\item[{}]{bboxes,  }\item[{}]{labels,  }\item[{}]{scale }\end{DoxyParamCaption})}



\mbox{\hyperlink{namespace_train}{Train}} step code 


\begin{DoxyParams}{매개변수}
{\em imgs} & input image \\
\hline
{\em bboxes} & B.\+B 정보 \\
\hline
{\em labels} & label 정보 \\
\hline
{\em scale} & 이미지 resize 비율 \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{반환값}
losses 
\end{DoxyReturn}


trainer.\+py 파일의 188 번째 라인에서 정의되었습니다.


\begin{DoxyCode}{0}
\DoxyCodeLine{188     \textcolor{keyword}{def }train\_step(self, imgs, bboxes, labels, scale):}
\DoxyCodeLine{189         self.optimizer.zero\_grad()}
\DoxyCodeLine{190         losses = self.forward(imgs, bboxes, labels, scale)}
\DoxyCodeLine{191         \textcolor{comment}{\# TODO: 단계별로 학습}}
\DoxyCodeLine{192         \textcolor{comment}{\# 현재는 RPN \& ROI 합친 loss backward}}
\DoxyCodeLine{193         losses.total\_loss.backward()}
\DoxyCodeLine{194         self.optimizer.step()}
\DoxyCodeLine{195         \textcolor{keywordflow}{return} losses}
\DoxyCodeLine{196 }

\end{DoxyCode}
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_ab0bc299051a745ffe6ef5c4660e05f51_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a7f8ea203d8d248e8df09e3d7c53581a4}\label{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a7f8ea203d8d248e8df09e3d7c53581a4}} 
\index{trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}!update\_meters@{update\_meters}}
\index{update\_meters@{update\_meters}!trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}}
\doxysubsubsection{\texorpdfstring{update\_meters()}{update\_meters()}}
{\footnotesize\ttfamily def trainer.\+trainer.\+Faster\+R\+C\+N\+N\+Trainer.\+update\+\_\+meters (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{losses }\end{DoxyParamCaption})}



trainer.\+py 파일의 245 번째 라인에서 정의되었습니다.


\begin{DoxyCode}{0}
\DoxyCodeLine{245     \textcolor{keyword}{def }update\_meters(self, losses):}
\DoxyCodeLine{246         loss\_d = \{k: at.scalar(v) \textcolor{keywordflow}{for} k, v \textcolor{keywordflow}{in} losses.\_asdict().items()\}}
\DoxyCodeLine{247         \textcolor{keywordflow}{for} key, meter \textcolor{keywordflow}{in} self.meters.items():}
\DoxyCodeLine{248             meter.add(loss\_d[key])}
\DoxyCodeLine{249 }

\end{DoxyCode}


\doxysubsection{멤버 데이터 문서화}
\mbox{\Hypertarget{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_abf7b9da182f3cc3943da1893fd267070}\label{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_abf7b9da182f3cc3943da1893fd267070}} 
\index{trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}!anchor\_target\_creator@{anchor\_target\_creator}}
\index{anchor\_target\_creator@{anchor\_target\_creator}!trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}}
\doxysubsubsection{\texorpdfstring{anchor\_target\_creator}{anchor\_target\_creator}}
{\footnotesize\ttfamily trainer.\+trainer.\+Faster\+R\+C\+N\+N\+Trainer.\+anchor\+\_\+target\+\_\+creator}



trainer.\+py 파일의 49 번째 라인에서 정의되었습니다.

\mbox{\Hypertarget{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a585898ea7cd93f2a4d0dec901ce9ad0b}\label{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a585898ea7cd93f2a4d0dec901ce9ad0b}} 
\index{trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}!faster\_rcnn@{faster\_rcnn}}
\index{faster\_rcnn@{faster\_rcnn}!trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}}
\doxysubsubsection{\texorpdfstring{faster\_rcnn}{faster\_rcnn}}
{\footnotesize\ttfamily trainer.\+trainer.\+Faster\+R\+C\+N\+N\+Trainer.\+faster\+\_\+rcnn}



trainer.\+py 파일의 44 번째 라인에서 정의되었습니다.

\mbox{\Hypertarget{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a1cc0be2dc6218efbe42b86b8556e99ac}\label{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a1cc0be2dc6218efbe42b86b8556e99ac}} 
\index{trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}!loc\_normalize\_mean@{loc\_normalize\_mean}}
\index{loc\_normalize\_mean@{loc\_normalize\_mean}!trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}}
\doxysubsubsection{\texorpdfstring{loc\_normalize\_mean}{loc\_normalize\_mean}}
{\footnotesize\ttfamily trainer.\+trainer.\+Faster\+R\+C\+N\+N\+Trainer.\+loc\+\_\+normalize\+\_\+mean}



trainer.\+py 파일의 52 번째 라인에서 정의되었습니다.

\mbox{\Hypertarget{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_abd942225e0f18bdd46b9a6db4d32e829}\label{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_abd942225e0f18bdd46b9a6db4d32e829}} 
\index{trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}!loc\_normalize\_std@{loc\_normalize\_std}}
\index{loc\_normalize\_std@{loc\_normalize\_std}!trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}}
\doxysubsubsection{\texorpdfstring{loc\_normalize\_std}{loc\_normalize\_std}}
{\footnotesize\ttfamily trainer.\+trainer.\+Faster\+R\+C\+N\+N\+Trainer.\+loc\+\_\+normalize\+\_\+std}



trainer.\+py 파일의 53 번째 라인에서 정의되었습니다.

\mbox{\Hypertarget{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_aa18be9d9e223d098f280c5ae7967e737}\label{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_aa18be9d9e223d098f280c5ae7967e737}} 
\index{trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}!optimizer@{optimizer}}
\index{optimizer@{optimizer}!trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}}
\doxysubsubsection{\texorpdfstring{optimizer}{optimizer}}
{\footnotesize\ttfamily trainer.\+trainer.\+Faster\+R\+C\+N\+N\+Trainer.\+optimizer}



trainer.\+py 파일의 55 번째 라인에서 정의되었습니다.

\mbox{\Hypertarget{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a0502776c51d33285e5be3d12ef074475}\label{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a0502776c51d33285e5be3d12ef074475}} 
\index{trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}!proposal\_target\_creator@{proposal\_target\_creator}}
\index{proposal\_target\_creator@{proposal\_target\_creator}!trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}}
\doxysubsubsection{\texorpdfstring{proposal\_target\_creator}{proposal\_target\_creator}}
{\footnotesize\ttfamily trainer.\+trainer.\+Faster\+R\+C\+N\+N\+Trainer.\+proposal\+\_\+target\+\_\+creator}



trainer.\+py 파일의 50 번째 라인에서 정의되었습니다.

\mbox{\Hypertarget{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a71c4bf599a2529633d3513294ac3b357}\label{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a71c4bf599a2529633d3513294ac3b357}} 
\index{trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}!roi\_sigma@{roi\_sigma}}
\index{roi\_sigma@{roi\_sigma}!trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}}
\doxysubsubsection{\texorpdfstring{roi\_sigma}{roi\_sigma}}
{\footnotesize\ttfamily trainer.\+trainer.\+Faster\+R\+C\+N\+N\+Trainer.\+roi\+\_\+sigma}



trainer.\+py 파일의 46 번째 라인에서 정의되었습니다.

\mbox{\Hypertarget{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a85782798c1dea1fdc3c842c4c6657f66}\label{classtrainer_1_1trainer_1_1_faster_r_c_n_n_trainer_a85782798c1dea1fdc3c842c4c6657f66}} 
\index{trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}!rpn\_sigma@{rpn\_sigma}}
\index{rpn\_sigma@{rpn\_sigma}!trainer.trainer.FasterRCNNTrainer@{trainer.trainer.FasterRCNNTrainer}}
\doxysubsubsection{\texorpdfstring{rpn\_sigma}{rpn\_sigma}}
{\footnotesize\ttfamily trainer.\+trainer.\+Faster\+R\+C\+N\+N\+Trainer.\+rpn\+\_\+sigma}



trainer.\+py 파일의 45 번째 라인에서 정의되었습니다.



이 클래스에 대한 문서화 페이지는 다음의 파일로부터 생성되었습니다.\+:\begin{DoxyCompactItemize}
\item 
trainer/\mbox{\hyperlink{trainer_8py}{trainer.\+py}}\end{DoxyCompactItemize}
