<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: model.utils.bbox_tools 네임스페이스 참조</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   &#160;<span id="projectnumber">v.0.1.0</span>
   </div>
   <div id="projectbrief">win64 Project Base</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 다음에 의해 생성됨 :  Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'검색');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','검색');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacemodel_1_1utils_1_1bbox__tools.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">함수</a>  </div>
  <div class="headertitle">
<div class="title">model.utils.bbox_tools 네임스페이스 참조</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
함수</h2></td></tr>
<tr class="memitem:a3924d351ba94dd9bd75de88ecbf9d738"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemodel_1_1utils_1_1bbox__tools.html#a3924d351ba94dd9bd75de88ecbf9d738">bbox2loc</a> (src_bbox, dst_bbox)</td></tr>
<tr class="separator:a3924d351ba94dd9bd75de88ecbf9d738"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a8e6b10ec7536583f4d8cb0f8386ee6"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemodel_1_1utils_1_1bbox__tools.html#a1a8e6b10ec7536583f4d8cb0f8386ee6">bbox_iou</a> (bbox_a, bbox_b)</td></tr>
<tr class="separator:a1a8e6b10ec7536583f4d8cb0f8386ee6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31b60cdafbb284e61cf8dcd87ee96a08"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemodel_1_1utils_1_1bbox__tools.html#a31b60cdafbb284e61cf8dcd87ee96a08">loc2bbox</a> (src_bbox, loc)</td></tr>
<tr class="separator:a31b60cdafbb284e61cf8dcd87ee96a08"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">함수 문서화</h2>
<a id="a3924d351ba94dd9bd75de88ecbf9d738"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3924d351ba94dd9bd75de88ecbf9d738">&#9670;&nbsp;</a></span>bbox2loc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def model.utils.bbox_tools.bbox2loc </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>src_bbox</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dst_bbox</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Encodes the source and the destination bounding boxes to "loc".

Given bounding boxes, this function computes offsets and scales
to match the source bounding boxes to the target bounding boxes.
Mathematcially, given a bounding box whose center is
:math:`(y, x) = p_y, p_x` and
size :math:`p_h, p_w` and the target bounding box whose center is
:math:`g_y, g_x` and size :math:`g_h, g_w`, the offsets and scales
:math:`t_y, t_x, t_h, t_w` can be computed by the following formulas.

* :math:`t_y = \\frac{(g_y - p_y)} {p_h}`
* :math:`t_x = \\frac{(g_x - p_x)} {p_w}`
* :math:`t_h = \\log(\\frac{g_h} {p_h})`
* :math:`t_w = \\log(\\frac{g_w} {p_w})`

The output is same type as the type of the inputs.
The encoding formulas are used in works such as R-CNN [#]_.

.. [#] Ross Girshick, Jeff Donahue, Trevor Darrell, Jitendra Malik. \
Rich feature hierarchies for accurate object detection and semantic \
segmentation. CVPR 2014.

Args:
    src_bbox (array): An image coordinate array whose shape is
        :math:`(R, 4)`. :math:`R` is the number of bounding boxes.
        These coordinates are
        :math:`p_{ymin}, p_{xmin}, p_{ymax}, p_{xmax}`.
    dst_bbox (array): An image coordinate array whose shape is
        :math:`(R, 4)`.
        These coordinates are
        :math:`g_{ymin}, g_{xmin}, g_{ymax}, g_{xmax}`.

Returns:
    array:
    Bounding box offsets and scales from :obj:`src_bbox` \
    to :obj:`dst_bbox`. \
    This has shape :math:`(R, 4)`.
    The second axis contains four values :math:`t_y, t_x, t_h, t_w`.</pre> 
<p class="definition"><a class="el" href="bbox__tools_8py_source.html">bbox_tools.py</a> 파일의 <a class="el" href="bbox__tools_8py_source.html#l00004">4</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keyword">def </span><a class="code" href="namespacemodel_1_1utils_1_1bbox__tools.html#a3924d351ba94dd9bd75de88ecbf9d738">bbox2loc</a>(src_bbox, dst_bbox):</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Encodes the source and the destination bounding boxes to &quot;loc&quot;.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="stringliteral">    Given bounding boxes, this function computes offsets and scales</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="stringliteral">    to match the source bounding boxes to the target bounding boxes.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="stringliteral">    Mathematcially, given a bounding box whose center is</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="stringliteral">    :math:`(y, x) = p_y, p_x` and</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="stringliteral">    size :math:`p_h, p_w` and the target bounding box whose center is</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="stringliteral">    :math:`g_y, g_x` and size :math:`g_h, g_w`, the offsets and scales</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="stringliteral">    :math:`t_y, t_x, t_h, t_w` can be computed by the following formulas.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="stringliteral">    * :math:`t_y = \\frac{(g_y - p_y)} {p_h}`</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="stringliteral">    * :math:`t_x = \\frac{(g_x - p_x)} {p_w}`</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="stringliteral">    * :math:`t_h = \\log(\\frac{g_h} {p_h})`</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="stringliteral">    * :math:`t_w = \\log(\\frac{g_w} {p_w})`</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="stringliteral">    The output is same type as the type of the inputs.</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="stringliteral">    The encoding formulas are used in works such as R-CNN [#]_.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="stringliteral">    .. [#] Ross Girshick, Jeff Donahue, Trevor Darrell, Jitendra Malik. \</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="stringliteral">    Rich feature hierarchies for accurate object detection and semantic \</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="stringliteral">    segmentation. CVPR 2014.</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="stringliteral">    Args:</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="stringliteral">        src_bbox (array): An image coordinate array whose shape is</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="stringliteral">            :math:`(R, 4)`. :math:`R` is the number of bounding boxes.</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="stringliteral">            These coordinates are</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="stringliteral">            :math:`p_{ymin}, p_{xmin}, p_{ymax}, p_{xmax}`.</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="stringliteral">        dst_bbox (array): An image coordinate array whose shape is</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="stringliteral">            :math:`(R, 4)`.</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="stringliteral">            These coordinates are</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="stringliteral">            :math:`g_{ymin}, g_{xmin}, g_{ymax}, g_{xmax}`.</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="stringliteral">    Returns:</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="stringliteral">        array:</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="stringliteral">        Bounding box offsets and scales from :obj:`src_bbox` \</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="stringliteral">        to :obj:`dst_bbox`. \</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="stringliteral">        This has shape :math:`(R, 4)`.</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="stringliteral">        The second axis contains four values :math:`t_y, t_x, t_h, t_w`.</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    height = src_bbox[:, 2] - src_bbox[:, 0]</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    width = src_bbox[:, 3] - src_bbox[:, 1]</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    ctr_y = src_bbox[:, 0] + 0.5 * height</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    ctr_x = src_bbox[:, 1] + 0.5 * width</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    base_height = dst_bbox[:, 2] - dst_bbox[:, 0]</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    base_width = dst_bbox[:, 3] - dst_bbox[:, 1]</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    base_ctr_y = dst_bbox[:, 0] + 0.5 * base_height</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    base_ctr_x = dst_bbox[:, 1] + 0.5 * base_width</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    eps = xp.finfo(height.dtype).eps</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    height = xp.maximum(height, eps)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    width = xp.maximum(width, eps)</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    dy = (base_ctr_y - ctr_y) / height</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    dx = (base_ctr_x - ctr_x) / width</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    dh = xp.log(base_height / height)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    dw = xp.log(base_width / width)</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    loc = xp.vstack((dy, dx, dh, dw)).transpose()</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">return</span> loc</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemodel_1_1utils_1_1bbox__tools_a3924d351ba94dd9bd75de88ecbf9d738_icgraph.png" border="0" usemap="#namespacemodel_1_1utils_1_1bbox__tools_a3924d351ba94dd9bd75de88ecbf9d738_icgraph" alt=""/></div>
<map name="namespacemodel_1_1utils_1_1bbox__tools_a3924d351ba94dd9bd75de88ecbf9d738_icgraph" id="namespacemodel_1_1utils_1_1bbox__tools_a3924d351ba94dd9bd75de88ecbf9d738_icgraph">
<area shape="rect" title=" " alt="" coords="260,57,468,84"/>
<area shape="rect" href="classmodel_1_1utils_1_1rpn__gt__loc__label_1_1_anchor_target_creator.html#ab58a5bf203b10b40374f04bc18aa8b6e" title="RPN을 통해서 예측한" alt="" coords="5,5,212,61"/>
<area shape="rect" href="classmodel_1_1utils_1_1roi__sample_1_1_proposal_target_creator.html#adfc2e83970eaaf5c717106872988d4ec" title="RPN 네트워크에서 뽑은 sample anchor 중에서 IoU를 기준으로 pos와 negative의 비율을 1:3으로 맞춰" alt="" coords="5,86,212,127"/>
</map>
</div>

</div>
</div>
<a id="a1a8e6b10ec7536583f4d8cb0f8386ee6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a8e6b10ec7536583f4d8cb0f8386ee6">&#9670;&nbsp;</a></span>bbox_iou()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def model.utils.bbox_tools.bbox_iou </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bbox_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bbox_b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate the Intersection of Unions (IoUs) between bounding boxes.

IoU is calculated as a ratio of area of the intersection
and area of the union.

This function accepts both :obj:`numpy.ndarray` and :obj:`cupy.ndarray` as
inputs. Please note that both :obj:`bbox_a` and :obj:`bbox_b` need to be
same type.
The output is same type as the type of the inputs.

Args:
    bbox_a (array): An array whose shape is :math:`(N, 4)`.
        :math:`N` is the number of bounding boxes.
        The dtype should be :obj:`numpy.float32`.
    bbox_b (array): An array similar to :obj:`bbox_a`,
        whose shape is :math:`(K, 4)`.
        The dtype should be :obj:`numpy.float32`.

Returns:
    array:
    An array whose shape is :math:`(N, K)`. \
    An element at index :math:`(n, k)` contains IoUs between \
    :math:`n` th bounding box in :obj:`bbox_a` and :math:`k` th bounding \
    box in :obj:`bbox_b`.</pre> 
<p class="definition"><a class="el" href="bbox__tools_8py_source.html">bbox_tools.py</a> 파일의 <a class="el" href="bbox__tools_8py_source.html#l00069">69</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="keyword">def </span><a class="code" href="namespacemodel_1_1utils_1_1bbox__tools.html#a1a8e6b10ec7536583f4d8cb0f8386ee6">bbox_iou</a>(bbox_a, bbox_b):</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Calculate the Intersection of Unions (IoUs) between bounding boxes.</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="stringliteral">    IoU is calculated as a ratio of area of the intersection</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="stringliteral">    and area of the union.</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="stringliteral">    This function accepts both :obj:`numpy.ndarray` and :obj:`cupy.ndarray` as</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="stringliteral">    inputs. Please note that both :obj:`bbox_a` and :obj:`bbox_b` need to be</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="stringliteral">    same type.</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="stringliteral">    The output is same type as the type of the inputs.</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="stringliteral">    Args:</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="stringliteral">        bbox_a (array): An array whose shape is :math:`(N, 4)`.</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="stringliteral">            :math:`N` is the number of bounding boxes.</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="stringliteral">            The dtype should be :obj:`numpy.float32`.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="stringliteral">        bbox_b (array): An array similar to :obj:`bbox_a`,</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="stringliteral">            whose shape is :math:`(K, 4)`.</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="stringliteral">            The dtype should be :obj:`numpy.float32`.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="stringliteral">    Returns:</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="stringliteral">        array:</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="stringliteral">        An array whose shape is :math:`(N, K)`. \</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="stringliteral">        An element at index :math:`(n, k)` contains IoUs between \</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="stringliteral">        :math:`n` th bounding box in :obj:`bbox_a` and :math:`k` th bounding \</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="stringliteral">        box in :obj:`bbox_b`.</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">if</span> bbox_a.shape[1] != 4 <span class="keywordflow">or</span> bbox_b.shape[1] != 4:</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">raise</span> IndexError</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment"># top left</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    tl = xp.maximum(bbox_a[:, <span class="keywordtype">None</span>, :2], bbox_b[:, :2])</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment"># bottom right</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    br = xp.minimum(bbox_a[:, <span class="keywordtype">None</span>, 2:], bbox_b[:, 2:])</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    area_i = xp.prod(br - tl, axis=2) * (tl &lt; br).all(axis=2)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    area_a = xp.prod(bbox_a[:, 2:] - bbox_a[:, :2], axis=1)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    area_b = xp.prod(bbox_b[:, 2:] - bbox_b[:, :2], axis=1)</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">return</span> area_i / (area_a[:, <span class="keywordtype">None</span>] + area_b - area_i)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
</div><!-- fragment --><div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemodel_1_1utils_1_1bbox__tools_a1a8e6b10ec7536583f4d8cb0f8386ee6_icgraph.png" border="0" usemap="#namespacemodel_1_1utils_1_1bbox__tools_a1a8e6b10ec7536583f4d8cb0f8386ee6_icgraph" alt=""/></div>
<map name="namespacemodel_1_1utils_1_1bbox__tools_a1a8e6b10ec7536583f4d8cb0f8386ee6_icgraph" id="namespacemodel_1_1utils_1_1bbox__tools_a1a8e6b10ec7536583f4d8cb0f8386ee6_icgraph">
<area shape="rect" title=" " alt="" coords="769,86,977,113"/>
<area shape="rect" href="classmodel_1_1utils_1_1roi__sample_1_1_proposal_target_creator.html#adfc2e83970eaaf5c717106872988d4ec" title="RPN 네트워크에서 뽑은 sample anchor 중에서 IoU를 기준으로 pos와 negative의 비율을 1:3으로 맞춰" alt="" coords="515,5,721,47"/>
<area shape="rect" href="classmodel_1_1utils_1_1rpn__gt__loc__label_1_1_anchor_target_creator.html#a4f50cf4a5663c99515b0d879b9ccdb61" title=" " alt="" coords="515,71,721,127"/>
<area shape="rect" href="namespaceutils_1_1eval__tool.html#a4c3aa581f1fb0e3db8877b9c50b648f3" title=" " alt="" coords="535,152,701,193"/>
<area shape="rect" href="classmodel_1_1utils_1_1rpn__gt__loc__label_1_1_anchor_target_creator.html#a4dd694d006acdfe57da3b221ca366bd7" title="1." alt="" coords="260,71,467,127"/>
<area shape="rect" href="classmodel_1_1utils_1_1rpn__gt__loc__label_1_1_anchor_target_creator.html#ab58a5bf203b10b40374f04bc18aa8b6e" title="RPN을 통해서 예측한" alt="" coords="5,71,212,127"/>
<area shape="rect" href="namespaceutils_1_1eval__tool.html#ad492f468b79187fc9e5441c757151f28" title=" " alt="" coords="300,152,427,193"/>
<area shape="rect" href="namespace_evaluation.html#ad8a1aa2d59b6d64bebd8713508b9b122" title=" " alt="" coords="55,155,162,182"/>
<area shape="rect" href="namespace_train.html#a073c054b09d56829c4927f2c5fe5d47a" title="&quot;MAP&quot;를 구하기 위한 함수" alt="" coords="71,206,147,233"/>
</map>
</div>

</div>
</div>
<a id="a31b60cdafbb284e61cf8dcd87ee96a08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31b60cdafbb284e61cf8dcd87ee96a08">&#9670;&nbsp;</a></span>loc2bbox()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def model.utils.bbox_tools.loc2bbox </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>src_bbox</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>loc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Decode bounding boxes from bounding box offsets and scales.

Given bounding box offsets and scales computed by
:meth:`bbox2loc`, this function decodes the representation to
coordinates in 2D image coordinates.

Given scales and offsets :math:`t_y, t_x, t_h, t_w` and a bounding
box whose center is :math:`(y, x) = p_y, p_x` and size :math:`p_h, p_w`,
the decoded bounding box's center :math:`\\hat{g}_y`, :math:`\\hat{g}_x`
and size :math:`\\hat{g}_h`, :math:`\\hat{g}_w` are calculated
by the following formulas.

* :math:`\\hat{g}_y = p_h t_y + p_y`
* :math:`\\hat{g}_x = p_w t_x + p_x`
* :math:`\\hat{g}_h = p_h \\exp(t_h)`
* :math:`\\hat{g}_w = p_w \\exp(t_w)`

The decoding formulas are used in works such as R-CNN [#]_.

The output is same type as the type of the inputs.

.. [#] Ross Girshick, Jeff Donahue, Trevor Darrell, Jitendra Malik. \
Rich feature hierarchies for accurate object detection and semantic \
segmentation. CVPR 2014.

Args:
    src_bbox (array): A coordinates of bounding boxes.
        Its shape is :math:`(R, 4)`. These coordinates are
        :math:`p_{ymin}, p_{xmin}, p_{ymax}, p_{xmax}`.
    loc (array): An array with offsets and scales.
        The shapes of :obj:`src_bbox` and :obj:`loc` should be same.
        This contains values :math:`t_y, t_x, t_h, t_w`.

Returns:
    array:
    Decoded bounding box coordinates. Its shape is :math:`(R, 4)`. \
    The second axis contains four values \
    :math:`\\hat{g}_{ymin}, \\hat{g}_{xmin},
    \\hat{g}_{ymax}, \\hat{g}_{xmax}`.</pre> 
<p class="definition"><a class="el" href="bbox__tools_8py_source.html">bbox_tools.py</a> 파일의 <a class="el" href="bbox__tools_8py_source.html#l00111">111</a> 번째 라인에서 정의되었습니다.</p>
<div class="fragment"><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keyword">def </span><a class="code" href="namespacemodel_1_1utils_1_1bbox__tools.html#a31b60cdafbb284e61cf8dcd87ee96a08">loc2bbox</a>(src_bbox, loc):</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Decode bounding boxes from bounding box offsets and scales.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="stringliteral">    Given bounding box offsets and scales computed by</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="stringliteral">    :meth:`bbox2loc`, this function decodes the representation to</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="stringliteral">    coordinates in 2D image coordinates.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="stringliteral">    Given scales and offsets :math:`t_y, t_x, t_h, t_w` and a bounding</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="stringliteral">    box whose center is :math:`(y, x) = p_y, p_x` and size :math:`p_h, p_w`,</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="stringliteral">    the decoded bounding box&#39;s center :math:`\\hat{g}_y`, :math:`\\hat{g}_x`</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="stringliteral">    and size :math:`\\hat{g}_h`, :math:`\\hat{g}_w` are calculated</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="stringliteral">    by the following formulas.</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="stringliteral">    * :math:`\\hat{g}_y = p_h t_y + p_y`</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="stringliteral">    * :math:`\\hat{g}_x = p_w t_x + p_x`</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="stringliteral">    * :math:`\\hat{g}_h = p_h \\exp(t_h)`</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="stringliteral">    * :math:`\\hat{g}_w = p_w \\exp(t_w)`</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="stringliteral">    The decoding formulas are used in works such as R-CNN [#]_.</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="stringliteral">    The output is same type as the type of the inputs.</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="stringliteral">    .. [#] Ross Girshick, Jeff Donahue, Trevor Darrell, Jitendra Malik. \</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="stringliteral">    Rich feature hierarchies for accurate object detection and semantic \</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="stringliteral">    segmentation. CVPR 2014.</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="stringliteral">    Args:</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="stringliteral">        src_bbox (array): A coordinates of bounding boxes.</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="stringliteral">            Its shape is :math:`(R, 4)`. These coordinates are</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="stringliteral">            :math:`p_{ymin}, p_{xmin}, p_{ymax}, p_{xmax}`.</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="stringliteral">        loc (array): An array with offsets and scales.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="stringliteral">            The shapes of :obj:`src_bbox` and :obj:`loc` should be same.</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="stringliteral">            This contains values :math:`t_y, t_x, t_h, t_w`.</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="stringliteral">    Returns:</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="stringliteral">        array:</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="stringliteral">        Decoded bounding box coordinates. Its shape is :math:`(R, 4)`. \</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="stringliteral">        The second axis contains four values \</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="stringliteral">        :math:`\\hat{g}_{ymin}, \\hat{g}_{xmin},</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="stringliteral">        \\hat{g}_{ymax}, \\hat{g}_{xmax}`.</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">if</span> src_bbox.shape[0] == 0:</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">return</span> xp.zeros((0, 4), dtype=loc.dtype)</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    src_bbox = src_bbox.astype(src_bbox.dtype, copy=<span class="keyword">False</span>)</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    src_height = src_bbox[:, 2] - src_bbox[:, 0]</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    src_width = src_bbox[:, 3] - src_bbox[:, 1]</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    src_ctr_y = src_bbox[:, 0] + 0.5 * src_height</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    src_ctr_x = src_bbox[:, 1] + 0.5 * src_width</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    dy = loc[:, 0::4]</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    dx = loc[:, 1::4]</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    dh = loc[:, 2::4]</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    dw = loc[:, 3::4]</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    ctr_y = dy * src_height[:, xp.newaxis] + src_ctr_y[:, xp.newaxis]</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    ctr_x = dx * src_width[:, xp.newaxis] + src_ctr_x[:, xp.newaxis]</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    h = xp.exp(dh) * src_height[:, xp.newaxis]</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    w = xp.exp(dw) * src_width[:, xp.newaxis]</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    dst_bbox = xp.zeros(loc.shape, dtype=loc.dtype)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    dst_bbox[:, 0::4] = ctr_y - 0.5 * h</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    dst_bbox[:, 1::4] = ctr_x - 0.5 * w</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    dst_bbox[:, 2::4] = ctr_y + 0.5 * h</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    dst_bbox[:, 3::4] = ctr_x + 0.5 * w</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">return</span> dst_bbox</div>
</div><!-- fragment --><div class="dynheader">
이 함수를 호출하는 함수들에 대한 그래프입니다.:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemodel_1_1utils_1_1bbox__tools_a31b60cdafbb284e61cf8dcd87ee96a08_icgraph.png" border="0" usemap="#namespacemodel_1_1utils_1_1bbox__tools_a31b60cdafbb284e61cf8dcd87ee96a08_icgraph" alt=""/></div>
<map name="namespacemodel_1_1utils_1_1bbox__tools_a31b60cdafbb284e61cf8dcd87ee96a08_icgraph" id="namespacemodel_1_1utils_1_1bbox__tools_a31b60cdafbb284e61cf8dcd87ee96a08_icgraph">
<area shape="rect" title=" " alt="" coords="220,13,428,39"/>
<area shape="rect" href="classmodel_1_1faster__rcnn_1_1_faster_r_c_n_n.html#a553586dc1bd599091a964f9fcc1cf154" title=" " alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespacemodel_1_1utils_1_1bbox__tools_html_a1a8e6b10ec7536583f4d8cb0f8386ee6"><div class="ttname"><a href="namespacemodel_1_1utils_1_1bbox__tools.html#a1a8e6b10ec7536583f4d8cb0f8386ee6">model.utils.bbox_tools.bbox_iou</a></div><div class="ttdeci">def bbox_iou(bbox_a, bbox_b)</div><div class="ttdef"><b>Definition:</b> <a href="bbox__tools_8py_source.html#l00069">bbox_tools.py:69</a></div></div>
<div class="ttc" id="anamespacemodel_1_1utils_1_1bbox__tools_html_a31b60cdafbb284e61cf8dcd87ee96a08"><div class="ttname"><a href="namespacemodel_1_1utils_1_1bbox__tools.html#a31b60cdafbb284e61cf8dcd87ee96a08">model.utils.bbox_tools.loc2bbox</a></div><div class="ttdeci">def loc2bbox(src_bbox, loc)</div><div class="ttdef"><b>Definition:</b> <a href="bbox__tools_8py_source.html#l00111">bbox_tools.py:111</a></div></div>
<div class="ttc" id="anamespacemodel_1_1utils_1_1bbox__tools_html_a3924d351ba94dd9bd75de88ecbf9d738"><div class="ttname"><a href="namespacemodel_1_1utils_1_1bbox__tools.html#a3924d351ba94dd9bd75de88ecbf9d738">model.utils.bbox_tools.bbox2loc</a></div><div class="ttdeci">def bbox2loc(src_bbox, dst_bbox)</div><div class="ttdef"><b>Definition:</b> <a href="bbox__tools_8py_source.html#l00004">bbox_tools.py:4</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacemodel.html">model</a></li><li class="navelem"><a class="el" href="namespacemodel_1_1utils.html">utils</a></li><li class="navelem"><a class="el" href="namespacemodel_1_1utils_1_1bbox__tools.html">bbox_tools</a></li>
    <li class="footer">다음에 의해 생성됨 : 
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
